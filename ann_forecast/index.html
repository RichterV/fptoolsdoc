
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Use continuous forest inventory databases to predict forest growth and yield.">
      
      
      
        <link rel="canonical" href="https://www.forestpytools.com/ann_forecast/">
      
      
        <link rel="prev" href="../clutter_forecast/">
      
      
        <link rel="next" href="../stratifier/">
      
      
      <link rel="icon" href="../images/favicon_2.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Prediction with Artificial Neural Networks - ForestPyTools</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/swiper-bundle.min.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Prediction with Artificial Neural Networks - ForestPyTools" >
      
        <meta  property="og:description"  content="Use continuous forest inventory databases to predict forest growth and yield." >
      
        <meta  property="og:image"  content="https://www.forestpytools.com/assets/images/social/ann_forecast.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://www.forestpytools.com/ann_forecast/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Prediction with Artificial Neural Networks - ForestPyTools" >
      
        <meta  name="twitter:description"  content="Use continuous forest inventory databases to predict forest growth and yield." >
      
        <meta  name="twitter:image"  content="https://www.forestpytools.com/assets/images/social/ann_forecast.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ann-forecast" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ForestPyTools" class="md-header__button md-logo" aria-label="ForestPyTools" data-md-component="logo">
      
  <img src="../images/logo1_no_background.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ForestPyTools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Prediction with Artificial Neural Networks
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="indigo"  aria-label="Dark Mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark Mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-green" data-md-color-accent="indigo"  aria-label="Light Mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light Mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../pt-BR/ann_forecast/" hreflang="pt-BR" class="md-select__link">
              PortuguÃªs
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ForestPyTools" class="md-nav__button md-logo" aria-label="ForestPyTools" data-md-component="logo">
      
  <img src="../images/logo1_no_background.png" alt="logo">

    </a>
    ForestPyTools
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    MÃ³dules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            MÃ³dules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_allocation_qgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory Planning QGIS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_allocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory Planning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hypsometric_relationship/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hypsometric Relationship
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tree_volume_planning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tree Volume Planninng
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../volumetrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Volumetrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sampling_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling Stats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assortments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assortments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forest_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forest Report
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" checked>
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Production Forecast
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Production Forecast
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clutter_forecast/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clutter Forecast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Ann Forecast
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Ann Forecast
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Class Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ann-trainer" class="md-nav__link">
    <span class="md-ellipsis">
      ANN Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ANN Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ann-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Ann structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ann-predictor" class="md-nav__link">
    <span class="md-ellipsis">
      ANN Predictor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ANN Predictor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tables" class="md-nav__link">
    <span class="md-ellipsis">
      Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    <span class="md-ellipsis">
      Files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stratifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stratifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extras
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Extras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bug_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bug Report
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about_the_author/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About the author
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Class Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ann-trainer" class="md-nav__link">
    <span class="md-ellipsis">
      ANN Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ANN Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ann-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Ann structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ann-predictor" class="md-nav__link">
    <span class="md-ellipsis">
      ANN Predictor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ANN Predictor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      Class Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tables" class="md-nav__link">
    <span class="md-ellipsis">
      Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    <span class="md-ellipsis">
      Files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ann-forecast">ANN Forecast</h1>
<hr />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This library is under development, none of the presented solutions are available for download.</p>
</div>
<p>Use continuous forest inventory databases to predict forest growth and production. Utilize artificial neural networks for greater flexibility. With this module, you will be able to estimate volume, the number of stems, basal area, among other variables of interest.</p>
<hr />
<h2 id="class-parameters">Class Parameters</h2>
<h2 id="ann-trainer">ANN Trainer</h2>
<div class="language-text highlight"><pre><span></span><code>AnnTrainer(df, y, *train_columns, iterator=None)
</code></pre></div>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>df</strong></td>
<td>The dataframe containing the continous processed forest inventory data.</td>
</tr>
<tr>
<td><strong>y</strong></td>
<td>The target variable for training the ANN (Y), the variable on which the ANN will be trained to predict.</td>
</tr>
<tr>
<td><strong>*train_columns</strong></td>
<td>(<code>*args</code>) Names of the columns that will be used to train the artificial neural network so that it can predict the values of Y. Must be numeric.</td>
</tr>
<tr>
<td><strong>iterator</strong></td>
<td>(Optional) Name of the column that contains the <code>iterator</code>. An artificial neural network will be adjusted for each <code>iterator</code>.</td>
</tr>
</tbody>
</table>
<h3 id="class-methods">Class Methods</h3>
<p class="annotate"><div class="language-py3 highlight"><span class="filename">methods and parameters</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>  <span class="n">AnnTrainer</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="c1">#(1)!</span>
</span></code></pre></div></p>
<ol>
<li><strong>save_dir</strong> = Directory where the <code>.pkl</code> ann file will be saved.</li>
</ol>
<table>
<thead>
<tr>
<th>Methods</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>.fit_model()</td>
<td>Adjust the model using <code>*train_columns</code> to predict the variable Y.</td>
</tr>
</tbody>
</table>
<h3 id="ann-structures">Ann structures</h3>
<p>6 different structures of artificial neural networks will be tested. Only the result from 1 model will be returned. The model returned will be selected by the ranking function.<br />
For the 'ann' model, the module <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html">sklearn.neural_network.MLPRegressor</a> is used.
<div class="mermaid">---
title: ANN Parameters
---
classDiagram
    direction LR

    class MLPRegressor {
      Epochs: 3000
      Activation: logistic
      Solver Mode: lbfgs
      Batch size: dynamic
      Learning rate init: 0.1
      Learning rate mode: adaptive
    }

    class Model-0 {
      Hidden layer sizes: (15, 25, 20, 30, 10)
    }
    class Model-1 {
      Hidden layer sizes: (35, 10, 25, 35, 15)

    }
    class Model-2 {
      Hidden layer sizes: (25, 15, 30, 20)

    }
    class Model-3 {
      Hidden layer sizes: (15, 35, 45)
    }
    class Model-4 {
      Hidden layer sizes: (35, 10, 25, 35, 15)
    }
    class Model-5 {
       Hidden layer sizes: (35, 10, 25, 35, 15, 20, 15, 30)
    }


    MLPRegressor &lt;|-- Model-0
    MLPRegressor &lt;|-- Model-1
    MLPRegressor &lt;|-- Model-2
    MLPRegressor &lt;|-- Model-3
    MLPRegressor &lt;|-- Model-4
    MLPRegressor &lt;|-- Model-5</div></p>
<h2 id="ann-predictor">ANN Predictor</h2>
<div class="language-text highlight"><pre><span></span><code>AnnPredictor(pkl_file)
</code></pre></div>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>pkl_file</strong></td>
<td>Directory of the <code>.pkl</code> file that will be used for prediction.</td>
</tr>
</tbody>
</table>
<h5 id="class-methods_1">Class Methods</h5>
<p class="annotate"><div class="language-py3 highlight"><span class="filename">methods and parameters</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>  <span class="n">AnnPredictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="c1">#(1)!</span>
</span></code></pre></div></p>
<ol>
<li>Returns the prediction of <code>Y</code> for the <code>*args</code> columns. The <code>*args</code> columns must be the same as those used in <code>*train_columns</code> for training.  </li>
</ol>
<h3 id="example-usage">Example Usage</h3>
<p>The main advantage of using artificial neural networks in the estimation of forest variables lies in the possibility of including a large number of variables in the prediction. However, currently, the neural networks in this module operate preferably with continuous variables. Therefore, when one wishes to use categorical variables, it is recommended to apply some kind of transformation, such as one-hot encoding, to convert them into a numerical format before inserting them into the network.</p>
<p>As an example, we will use an adaptation of the data obtained by Arce and Dobner Jr. (2024) for <em>Eucalyptus dunnii</em>. The dataset consists of 81 permanent plots, with ages ranging from 3 to 9 years, measured continuously over time.</p>
<p><a href="../downloads/forecast/dados_ann.xlsx" download style="text-decoration: none; font-weight: bold;">
  <i class="fa-solid fa-file-arrow-down" style="margin-right: 8px;"></i>Download the file.
</a></p>
<p>First 5 rows of the file:</p>
<table>
<thead>
<tr>
<th>Chave_Parcela</th>
<th>Area_m2</th>
<th>Idade</th>
<th>N_ha</th>
<th>d mÃ©dio</th>
<th>h mÃ©dio</th>
<th>H dom</th>
<th>G_m2_ha</th>
<th>V_m3_ha</th>
<th>S</th>
</tr>
</thead>
<tbody>
<tr>
<td>14401109002_P1</td>
<td>300</td>
<td>3</td>
<td>933</td>
<td>7.47</td>
<td>6.8</td>
<td>7.4</td>
<td>4.2</td>
<td>6.0</td>
<td>15.4</td>
</tr>
<tr>
<td>14401109002_P1</td>
<td>300</td>
<td>4</td>
<td>933</td>
<td>10.3</td>
<td>10.1</td>
<td>10.8</td>
<td>8.0</td>
<td>24.5</td>
<td>15.4</td>
</tr>
<tr>
<td>14401109002_P1</td>
<td>300</td>
<td>5</td>
<td>933</td>
<td>14.0</td>
<td>12.8</td>
<td>13.7</td>
<td>14.9</td>
<td>67.1</td>
<td>15.4</td>
</tr>
<tr>
<td>14401109002_P1</td>
<td>300</td>
<td>6</td>
<td>933</td>
<td>14.1</td>
<td>14.5</td>
<td>15.4</td>
<td>15.1</td>
<td>77.2</td>
<td>15.4</td>
</tr>
<tr>
<td>14401109002_P1</td>
<td>300</td>
<td>7</td>
<td>867</td>
<td>16.6</td>
<td>16.1</td>
<td>16.5</td>
<td>19.4</td>
<td>112.8</td>
<td>15.4</td>
</tr>
</tbody>
</table>
<p>In this case, we will use the columns "Idade", "N_ha", "d mÃ©dio", "h mÃ©dio", "H dom", "G_m2_ha", and "S" to predict the value of "V_m3_ha".</p>
<p class="annotate"><div class="language-py3 highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">exemplo_previsao_rna.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fptools.forecast</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnnTrainer</span><span class="p">,</span> <span class="n">AnnPredictor</span><span class="c1">#(1)!</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span><span class="c1">#(2)!</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span><span class="c1">#(3)!</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Importa a classe <code>AnnTrainer</code> e <code>AnnPredictor</code> do mÃ³dulo <code>forecast</code>.</li>
<li>Importa <code>pandas</code> para manipulaÃ§Ã£o de dados.</li>
<li>Importa <code>train_test_split</code> para dividir dados em treino e validaÃ§Ã£o.</li>
</ol>
<p class="annotate"><div class="language-py3 highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">exemplo_previsao_rna.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Your/directory/to/dados_ann.xlsx&quot;</span><span class="c1">#(1)!</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="n">dados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="c1">#(2)!</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="hll"><span class="n">dados_treino</span><span class="p">,</span> <span class="n">dados_validacao</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dados</span><span class="p">,</span>
</span></span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a>                                                <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a>                                                <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="c1">#(3)!</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="n">train_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Idade&quot;</span><span class="p">,</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a>                 <span class="s2">&quot;N_ha&quot;</span><span class="p">,</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a>                 <span class="s2">&quot;d mÃ©dio&quot;</span><span class="p">,</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a>                 <span class="s2">&quot;h mÃ©dio&quot;</span><span class="p">,</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a>                 <span class="s2">&quot;H dom&quot;</span><span class="p">,</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a>                 <span class="s2">&quot;G_m2_ha&quot;</span><span class="p">,</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a>                 <span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="c1">#(4)!</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20"></a>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="n">ann</span> <span class="o">=</span> <span class="n">AnnTrainer</span><span class="p">(</span><span class="n">dados_treino</span><span class="p">,</span> <span class="s2">&quot;V_m3_ha&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">train_columns</span><span class="p">)</span><span class="c1">#(5)!        </span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22"></a>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="n">metrics</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Your/directory/to/save&quot;</span><span class="p">)</span><span class="c1">#(6)!  </span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Define the directory where the data in xlsx format is located, saving it in the variable <code>path</code>.</li>
<li>Load the data and save it in the variable <code>dados</code>.</li>
<li>Save 80% of the data as training data in the variable <code>dados_treino</code> and 20% as validation data in the variable <code>dados_validacao</code>, using a random seed of 42.</li>
<li>Create a variable called <code>train_columns</code> containing the list of column names to be used for training.</li>
<li>Instantiate the class <code>AnnTrainer</code>, saving it in the variable <code>ann</code>, passing the training data, the column <code>V_m3_ha</code> as the target variable, and the list of training columns.</li>
<li>Fit the neural network model, saving the metrics in the variable <code>metrics</code> and the generated <code>.pkl</code> file in the defined directory.</li>
</ol>
<p>After that, the trained model will be ready for use. We can test the performance of our model by using it to predict the validation data saved in <code>dados_validacao</code>.</p>
<p class="annotate"><div class="language-py3 highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">exemplo_previsao_rna.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fptools.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_metrics</span> <span class="c1">#(1)!</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="n">predictor</span> <span class="o">=</span> <span class="n">AnnPredictor</span><span class="p">(</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="hll">                        <span class="sa">r</span><span class="s2">&quot;Your/directory/to/save/V_m3_ha_ann_predictor.pkl&quot;</span>
</span></span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a>                        <span class="p">)</span><span class="c1">#(2)!</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="n">dados_validacao</span><span class="p">[</span><span class="s1">&#39;V_m3_ha_predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31"></a>                                                         <span class="n">dados_validacao</span><span class="p">,</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32"></a>                                                        <span class="o">*</span><span class="n">train_columns</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33"></a>                                                        <span class="p">)</span><span class="c1">#(3)!</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34"></a>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">r_squared</span><span class="p">,</span> <span class="n">exp_var</span><span class="p">,</span> <span class="n">m_error</span> <span class="o">=</span> <span class="n">get_metrics</span><span class="p">(</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36"></a>                                                                <span class="n">dados_validacao</span><span class="p">[</span><span class="s1">&#39;V_m3_ha&#39;</span><span class="p">],</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37"></a>                                                                <span class="n">dados_validacao</span><span class="p">[</span><span class="s1">&#39;V_m3_ha_predicted&#39;</span><span class="p">]</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38"></a>                                                                <span class="p">)</span><span class="c1">#(4)!</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39"></a><span class="n">metrics_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40"></a>    <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mae</span><span class="p">],</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41"></a>    <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape</span><span class="p">],</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42"></a>    <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mse</span><span class="p">],</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43"></a>    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse</span><span class="p">],</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44"></a>    <span class="s1">&#39;R squared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r_squared</span><span class="p">],</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45"></a>    <span class="s1">&#39;Explained Var&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">exp_var</span><span class="p">],</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46"></a>    <span class="s1">&#39;Mean Error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">m_error</span><span class="p">]</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47"></a><span class="p">})</span><span class="c1">#(5)!</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Import the function <code>get_metrics</code> from the <code>utils</code> module for later metric calculation.</li>
<li>Instantiate the class <code>AnnPredictor</code>, saving it in the variable <code>predictor</code>, and passing the <code>.pkl</code> file generated during the neural network training.</li>
<li>Create the column <code>V_m3_ha_predicted</code> in the <code>dados_validacao</code> DataFrame, containing the predictions made by the trained ANN for the training columns in the <code>dados_validacao</code> DataFrame.</li>
<li>Use the <code>get_metrics</code> function to obtain the metrics between the actual values <code>V_m3_ha</code> and the predicted values <code>V_m3_ha_predicted</code> from the <code>dados_validacao</code> DataFrame. The returned metrics are: <strong>MAE (Mean Absolute Error)</strong>, <strong>MAPE (Mean Absolute Percentage Error)</strong>, <strong>MSE (Mean Squared Error)</strong>, <strong>RMSE (Root Mean Squared Error)</strong>, <strong>RÂ² (Coefficient of Determination)</strong>, <strong>EXP_VAR (Explained Variance Score)</strong>, and <strong>ME (Mean Error)</strong>.</li>
<li>Create a DataFrame with the validation metrics.</li>
</ol>
<h4 id="outputs">Outputs</h4>
<h5 id="tables">Tables</h5>
<p><code>metrics</code>(1)</p>
<p>{ .annotate }</p>
<ol>
<li>Table with the performance metrics of the ANN during training.</li>
</ol>
<table>
<thead>
<tr>
<th>Iterator</th>
<th>Model</th>
<th>MSE</th>
<th>RMSE</th>
<th>MAE</th>
<th>MAPE</th>
<th>RÂ²</th>
<th>Explained Variance</th>
<th>Max Error</th>
</tr>
</thead>
<tbody>
<tr>
<td>Not used</td>
<td>V_m3_ha_ann_predictor</td>
<td>32.29</td>
<td>5.68</td>
<td>3.05</td>
<td>4.23</td>
<td>0.99</td>
<td>0.99</td>
<td>0.14</td>
</tr>
</tbody>
</table>
<p class="annotate"><code>metrics_val</code>(1)</p>
<ol>
<li>Table with the performance metrics of the ANN on validation.</li>
</ol>
<table>
<thead>
<tr>
<th>MAE</th>
<th>MAPE</th>
<th>MSE</th>
<th>RMSE</th>
<th>RÂ²</th>
<th>Explained Variance</th>
<th>Mean Error</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.99</td>
<td>3.28</td>
<td>26.13</td>
<td>5.11</td>
<td>0.99</td>
<td>0.99</td>
<td>0.12</td>
</tr>
</tbody>
</table>
<h5 id="files">Files</h5>
<p class="annotate"><code>V_m3_ha_ann_predictor.pkl</code>(1)</p>
<ol>
<li><code>.pkl</code> file containing the trained ANN parameters.</li>
</ol>
<p><a href="../downloads/forecast/V_m3_ha_ann_predictor.pkl" download style="text-decoration: none; font-weight: bold;">
  <i class="fa-solid fa-file-arrow-down" style="margin-right: 8px;"></i>Download the file.
</a></p>
<h2 id="references">References</h2>
<section id="references">
  <div>
    <p><strong>ARCE, JULIO EDUARDO; DOBNER JR., MARIO.</strong> (2024).  
    <em>Manejo e planejamento de florestas plantadas: com Ãªnfase nos gÃªneros Pinus e Eucalyptus</em>. Curitiba, PR: Ed. dos Autores, 419p.</p>
  </div>
</section>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../clutter_forecast/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Clutter Forecast">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Clutter Forecast
              </div>
            </div>
          </a>
        
        
          
          <a href="../stratifier/" class="md-footer__link md-footer__link--next" aria-label="Next: Stratifier">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Stratifier
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2024 Vinicius Richter
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/viniciusrichteref/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/RichterV" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<vinicius00rich@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "content.code.copy", "content.footnote.tooltips", "navigation.footer", "navigation.sections", "navigation.top", "content.code.annotate", "content.code.select"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../assets/js/plotly-latest.min.js"></script>
      
        <script src="../assets/js/swiper-bundle.min.js"></script>
      
        <script src="../assets/js/mermaid.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
    
  </body>
</html>